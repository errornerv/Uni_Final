<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Traffic Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body class="font-poppins bg-gradient-to-br from-light-bg to-light-gray text-text-dark overflow-x-hidden">
    <div id="main-content" class="main-content ml-[250px] p-5 transition-all duration-300 w-[calc(100%-250px)]">
        <header class="bg-dark-blue text-white p-4 px-5 sticky top-0 z-[1000] flex justify-between items-center shadow-[0_2px_10px_rgba(0,0,0,0.2)] h-[60px]">
            <button onclick="toggleSidebar()" class="sidebar-toggle bg-transparent border-none text-white text-2xl cursor-pointer transition-transform duration-300 hover:scale-110"><i class="fas fa-bars"></i></button>
            <h1 class="text-2xl m-0">Network Traffic Dashboard</h1>
            <button onclick="toggleAddOrderForm()" class="add-order-toggle bg-teal border-none px-4 py-2 rounded text-white text-base font-medium cursor-pointer transition-all duration-300 flex items-center gap-2 hover:bg-blue-hover hover:scale-105">
                <i class="fas fa-plus text-lg"></i> Add New Order
            </button>
            <button onclick="toggleTheme()" class="theme-toggle bg-transparent border-none text-white text-xl cursor-pointer transition-transform duration-300 hover:scale-110"><i class="fas fa-moon"></i></button>
        </header>
        <div id="sidebar" class="sidebar w-[250px] bg-sidebar-bg text-white fixed top-0 left-0 h-screen p-5 transition-transform duration-300 z-[999]">
            <h2 class="text-2xl mb-5">Menu</h2>
            <ul>
                <li><a href="#" class="menu-item px-5 py-4 mb-4 rounded-lg cursor-pointer transition-colors duration-300 flex items-center gap-3 text-xl text-text-light bg-sidebar-menu shadow-menu hover:bg-sidebar-hover" onclick="toggleSubMenu('run-menu')"><i class="fas fa-play text-2xl"></i> Run Project <i id="run-menu-icon" class="fas fa-chevron-down"></i></a>
                    <ul id="run-menu" class="sub-menu hidden pl-5">
                        <li><a href="#" onclick="runScript('01')" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Initial Data</a></li>
                        <li><a href="#" onclick="runScript('02')" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Congestion</a></li>
                        <li><a href="#" onclick="runScript('03')" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Managed Traffic</a></li>
                        <li><a href="#" onclick="runScript('04')" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">New Orders</a></li>
                        <li><a href="#" onclick="runScript('05')" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Real-Time Orders</a></li>
                        <li><a href="#" onclick="runScript('06')" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Traffic Data Preparation</a></li>
                        <li><a href="#" onclick="runScript('07')" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Model Training</a></li>
                        <li><a href="#" onclick="runScript('08')" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Advanced Traffic Report</a></li>
                        <li><a href="#" onclick="runScript('09')" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Smart Traffic Management</a></li>
                        <li><a href="#" onclick="runScript('12')" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Predictive Analysis</a></li>
                        <li><a href="#" onclick="runScript('self_healing')" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Self-Healing Network</a></li>
                        <li><a href="#" onclick="runScript('init')" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Initialize</a></li>
                    </ul>
                </li>
                <li><a href="#" class="menu-item px-5 py-4 mb-4 rounded-lg cursor-pointer transition-colors duration-300 flex items-center gap-3 text-xl text-text-light bg-sidebar-menu shadow-menu hover:bg-sidebar-hover" onclick="toggleSubMenu('report-menu')"><i class="fas fa-file-alt text-2xl"></i> Reports <i id="report-menu-icon" class="fas fa-chevron-down"></i></a>
                    <ul id="report-menu" class="sub-menu hidden pl-5">
                        <li><a href="/report/initial_data" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Initial Data</a></li>
                        <li><a href="/report/congestion" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Congestion</a></li>
                        <li><a href="/report/managed_traffic" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Managed Traffic</a></li>
                        <li><a href="/report/new_orders" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">New Orders</a></li>
                        <li><a href="/report/real_time_orders" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Real-Time Orders</a></li>
                        <li><a href="/report/12" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Predictive Analysis</a></li>
                        <li><a href="/report/self_healing" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Self-Healing Network</a></li>
                        <li><a href="/report/smart_traffic" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Smart Traffic</a></li>
                        <li><a href="/report/traffic_report" class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">Traffic Report</a></li>
                    </ul>
                </li>
                <li><a href="#" class="menu-item px-5 py-4 mb-4 rounded-lg cursor-pointer transition-colors duration-300 flex items-center gap-3 text-xl text-text-light bg-sidebar-menu shadow-menu hover:bg-sidebar-hover" onclick="toggleSubMenu('details-menu')"><i class="fas fa-info-circle text-2xl"></i> Project Details <i id="details-menu-icon" class="fas fa-chevron-down"></i></a>
                    <ul id="details-menu" class="sub-menu hidden pl-5">
                        <li>
                            <p class="w-full text-left bg-sidebar-menu border-none p-3 m-1 rounded text-text-light transition-colors duration-300 block text-base hover:bg-sidebar-hover">This dashboard monitors network traffic in real-time, providing insights into traffic volume, network health, latency, and traffic type distribution. It supports blockchain-based traffic management and self-healing networks.</p>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
        <!-- فرم جدید برای اضافه کردن سفارش -->
        <div id="add-order-section" class="bg-gradient-to-br from-white to-gray-light p-5 rounded-lg shadow-light border border-gray-border mb-5 opacity-0 max-h-0 overflow-hidden transition-all duration-500">
            <h3 class="text-2xl text-dark-blue mb-5 text-center font-semibold">Add New Order</h3>
            <form id="add-order-form">
                <div class="mb-4">
                    <label for="order_node_id" class="font-semibold text-sm text-text-dark mb-2 block">Node ID:</label>
                    <select class="w-full p-3 border border-gray-border rounded focus:outline-none focus:ring-2 focus:ring-teal bg-gray-50 transition-all duration-300 hover:border-teal focus:bg-white" id="order_node_id" name="node_id" required>
                        <option value="">Select Node</option>
                        <option value="Node_1">Node 1</option>
                        <option value="Node_2">Node 2</option>
                        <option value="Node_3">Node 3</option>
                        <option value="Node_4">Node 4</option>
                        <option value="Node_5">Node 5</option>
                        <option value="Node_6">Node 6</option>
                        <option value="Node_7">Node 7</option>
                        <option value="Node_8">Node 8</option>
                        <option value="Node_9">Node 9</option>
                        <option value="Node_10">Node 10</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label for="order_traffic_type" class="font-semibold text-sm text-text-dark mb-2 block">Traffic Type:</label>
                    <select class="w-full p-3 border border-gray-border rounded focus:outline-none focus:ring-2 focus:ring-teal bg-gray-50 transition-all duration-300 hover:border-teal focus:bg-white" id="order_traffic_type" name="traffic_type" required>
                        <option value="">Select Traffic Type</option>
                        <option value="Data">Data</option>
                        <option value="Stream">Stream</option>
                        <option value="Game">Game</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label for="order_traffic_volume" class="font-semibold text-sm text-text-dark mb-2 block">Traffic Volume (MB/s):</label>
                    <input type="number" step="0.01" class="w-full p-3 border border-gray-border rounded focus:outline-none focus:ring-2 focus:ring-teal bg-gray-50 transition-all duration-300 hover:border-teal focus:bg-white" id="order_traffic_volume" name="traffic_volume" placeholder="Enter Traffic Volume" required>
                </div>
                <div class="mb-4">
                    <label for="order_network_health" class="font-semibold text-sm text-text-dark mb-2 block">Network Health:</label>
                    <select class="w-full p-3 border border-gray-border rounded focus:outline-none focus:ring-2 focus:ring-teal bg-gray-50 transition-all duration-300 hover:border-teal focus:bg-white" id="order_network_health" name="network_health" required>
                        <option value="">Select Network Health</option>
                        <option value="Normal">Normal</option>
                        <option value="Delayed">Delayed</option>
                        <option value="Down">Down</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label for="order_latency" class="font-semibold text-sm text-text-dark mb-2 block">Latency (ms):</label>
                    <input type="number" step="0.01" class="w-full p-3 border border-gray-border rounded focus:outline-none focus:ring-2 focus:ring-teal bg-gray-50 transition-all duration-300 hover:border-teal focus:bg-white" id="order_latency" name="latency" placeholder="Enter Latency" required>
                </div>
                <button type="submit" class="px-5 py-3 rounded font-semibold cursor-pointer transition-all duration-300 bg-teal text-white hover:bg-blue-hover hover:scale-102 w-full text-base">Add Order</button>
            </form>
            <div id="form-message" class="mt-2 text-center text-sm font-medium p-2 rounded">
                <span style="color: green;" class="bg-green-100 text-green-success px-3 py-1 rounded"></span>
                <span style="color: red;" class="bg-red-100 text-red-error px-3 py-1 rounded"></span>
                <span style="color: blue;" class="bg-blue-100 text-blue-hover px-3 py-1 rounded"></span>
            </div>
        </div>
        <div id="loading" class="loading hidden text-center mt-5 fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-black/70 p-5 rounded-lg text-white z-[1000]">
            <div class="spinner-border w-12 h-12 border-4 animate-spin animate-pulse"></div>
            <p class="mt-3 text-lg">Loading...</p>
        </div>
        <!-- Filter Section -->
        <div class="filter-section flex flex-wrap gap-4 mb-5 items-center bg-white p-4 rounded-lg shadow-light animate-fadeIn border border-gray-border w-full max-w-4xl mx-auto">
            <label for="node-filter" class="font-semibold text-sm text-dark-blue mr-2">Node ID:</label>
            <select id="node-filter" class="p-2 px-3 rounded border border-gray-border text-sm bg-gray-50 transition-all duration-300 min-w-[120px] hover:border-teal focus:outline-none focus:border-teal focus:shadow-[0_0_8px_rgba(75,192,192,0.3)] focus:bg-white">
                <option value="">All Nodes</option>
                <option value="Node_1">Node 1</option>
                <option value="Node_2">Node 2</option>
                <option value="Node_3">Node 3</option>
                <option value="Node_4">Node 4</option>
                <option value="Node_5">Node 5</option>
                <option value="Node_6">Node 6</option>
                <option value="Node_7">Node 7</option>
                <option value="Node_8">Node 8</option>
                <option value="Node_9">Node 9</option>
            </select>

            <label for="type-filter" class="font-semibold text-sm text-dark-blue mr-2">Traffic Type:</label>
            <select id="type-filter" class="p-2 px-3 rounded border border-gray-border text-sm bg-gray-50 transition-all duration-300 min-w-[120px] hover:border-teal focus:outline-none focus:border-teal focus:shadow-[0_0_8px_rgba(75,192,192,0.3)] focus:bg-white">
                <option value="">All Types</option>
                <option value="data">Data</option>
                <option value="video">Video</option>
                <option value="audio">Audio</option>
            </select>

            <label for="time-filter" class="font-semibold text-sm text-dark-blue mr-2">Time Range:</label>
            <select id="time-filter" class="p-2 px-3 rounded border border-gray-border text-sm bg-gray-50 transition-all duration-300 min-w-[120px] hover:border-teal focus:outline-none focus:border-teal focus:shadow-[0_0_8px_rgba(75,192,192,0.3)] focus:bg-white">
                <option value="">All Time</option>
                <option value="1m">Last 1 Minute</option>
                <option value="5m">Last 5 Minutes</option>
            </select>
        </div>
        <!-- Charts Section -->
        <div class="dashboard-grid grid grid-cols-[repeat(auto-fit,minmax(300px,1fr))] gap-5 mb-5">
            <div class="chart-card bg-white rounded-lg shadow-medium p-4 transition-transform duration-200 hover:-translate-y-1">
                <h3>Traffic Volume (MB/s)</h3>
                <canvas id="trafficChart" width="300" height="150"></canvas>
            </div>
            <div class="chart-card bg-white rounded-lg shadow-medium p-4 transition-transform duration-200 hover:-translate-y-1">
                <h3>Network Health</h3>
                <canvas id="healthChart" width="300" height="150"></canvas>
            </div>
            <div class="chart-card bg-white rounded-lg shadow-medium p-4 transition-transform duration-200 hover:-translate-y-1">
                <h3>Latency (ms)</h3>
                <canvas id="latencyChart" width="300" height="150"></canvas>
            </div>
            <div class="chart-card bg-white rounded-lg shadow-medium p-4 transition-transform duration-200 hover:-translate-y-1">
                <h3>Traffic Type Distribution</h3>
                <canvas id="typeChart" width="300" height="150"></canvas>
            </div>
            <div class="chart-card bg-white rounded-lg shadow-medium p-4 transition-transform duration-200 hover:-translate-y-1">
                <h3>Congestion Prediction</h3>
                <canvas id="predictionChart" width="300" height="150"></canvas>
            </div>
        </div>
        <div id="script-outputs"></div>
        <div class="floating-toolbar fixed bottom-5 left-1/2 -translate-x-1/2 flex justify-center gap-3 z-[1000]">
            <button onclick="stopAllScripts()" class="bg-red-error border-none px-4 py-2 rounded text-white transition-all duration-200 hover:bg-red-hover hover:scale-105"><i class="fas fa-stop"></i> <span id="stop-button-text">Stop All Scripts</span></button>
            <button onclick="clearTerminal()" class="bg-red-error border-none px-4 py-2 rounded text-white transition-all duration-200 hover:bg-red-hover hover:scale-105"><i class="fas fa-trash-alt"></i> Clear Terminal</button>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.1/socket.io.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>